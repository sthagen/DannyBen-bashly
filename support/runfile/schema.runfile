summary 'Run json-schema checks on all examples'

help   'Test the bashly schema against all examples'
action :examples do
  Example.all.each do |example|
    file = example.yaml_path
    command = "check-jsonschema --schemafile schemas/bashly.json #{file}"
    say "\n$ check-jsonschema bb`#{example.dir}`"
    success = system command
    abort 'Failed' unless success
  end
end

help   'Test the settings schema against the default settings template'
action :settings do
  file = 'lib/bashly/libraries/settings/settings.yml'
  command = "check-jsonschema --schemafile schemas/settings.json #{file}"
  say "\n$ check-jsonschema bb`#{file}`"
  success = system command
  abort 'Failed' unless success
end

help   'Test the strings schema against the default strings template'
action :strings do
  file = 'lib/bashly/libraries/strings/strings.yml'
  command = "check-jsonschema --schemafile schemas/strings.json #{file}"
  say "\n$ check-jsonschema bb`#{file}`"
  success = system command
  abort 'Failed' unless success
end
